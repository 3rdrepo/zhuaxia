

[中文介绍](README.md)


####Table of contents
(toc is generated by [ghtoc](https://github.com/sk1418/ghtoc))
- [Introduction](#introduction)
- [Dependencies](#dependencies)
- [Features](#features)
- [Installation](#installation)
- [Usage](#usage)
	- [download xiami resource outside China](#proxy-setting)
- [Screenshots](#screenshots)
- [Change logs](#changelog)


## Introduction

zhuaxia(抓虾) (MIT Licensed) is a little tool to batch download music resources in multiple threads from www.xiami.com (in short `[xia]`) and music.163.com (in short `[163]`). 


**zhuaxia** was written and tested with:
- python 2.7.6


##Dependencies

- requests module
- mutagen module
- beautifulsoup4 module

##Features

- automatically recognize and parse URLs, so far it supports:
	- [xia] 歌曲，专辑，精选集，用户收藏[todo], 歌手热门
	- [163] 歌曲，专辑，歌单，歌手热门
- artist Top N(configurable) Songs.([xia]max:20), default Top10. Configuration property: `download.artist.topsong` artist page url is needed
- download mixed urls in file. URLs can be mixed by [xia] and [163], also they can be different resource types (`-f` option)
- when download from file, multi-threading parsing the urls with a configurable thread pool
- multi-threading download with configurable thread pool.
- download HQ (320kbps) resources  (`-H` option)
- user friendly downloading progress display (colorful highlighting, adapt terminal width automatically, total progress, downloading thread progress...)
- mp3 renaming, mp3 meta data updating, auto-download album cover image. Album description(only[xia])...
- [xia]configuration property `xiami.proxy.http=ip:port` for xiami resource downloading via China proxy. Details："Usage -> [download xiami resource outside China](#proxy-setting)"
- `-p` option (experimental function)，using a proxypool to solve the problem of "ip was banned if requests to a server were too often.


##Installation

Archlinux user, zhuaxia can be found in AUR

Stable version (master branch):

	yaourt -S zhuaxia

latest git version (bleeding branch):

	yaourt -S zhuaxia-git

other users:

	sudo python setup.py install

## Usage

- configuration file: after first time running `zx`,  `zhuaxia.conf` will automatically generated under `$HOME/.zhuaxia/` check the comment in config file for details

- Usage:


		zhuaxia (抓虾) -- 抓取[虾米音乐]和[网易云音乐]的 mp3 音乐

		[CONFIG FILE:]   $HOME/.zhuaxia/zhuaxia.conf

		[OPTIONS] 
			-H : 首选HQ质量(320kbps), 
				> 虾米音乐 <
					- 配置文件中需给出正确登录信箱和密码, 登录用户需拥有VIP身份
					- 用户需在xiami vip设置页面设置默认高音质
					- 此选项对不满足上两项情况无效，仍下载128kbps资源
				> 网易音乐 <
					-无需特殊要求,直接下载高音质资源

			-p : (实验性选项)使用代理池下载
				在下载/解析量大的情况下，目标服务器会对禁止频繁的请求，所以zhuaxia可以自动获取
				代理来解析和下载资源。因为获取的代理速度/可靠性不一，下载可能会缓慢或不稳定。

			-h ：显示帮助
			-f ：从文件下载
			-v ：显示版本信息

		[USAGE] 

			zx [OPTION] <URL>
				: 下载指定URL资源, 抓虾自动识别链接, 支持
					- [xia] 歌曲，专辑，精选集，用户收藏,艺人TopN
					- [163] 歌曲，专辑，歌单，艺人TopN
				例子： 
				  zx "http://www.xiami.com/space/lib-song/u/25531126"
				  zx "http://music.163.com/song?id=27552647"

			zx [OPTION] -f <file> 
				: 多个URL在一个文件中，每个URL一行。 URLs可以是混合[xia]和[163]的不同类型音乐资源。例子：
				  $ cat /tmp/foo.txt
					http://music.163.com/artist?id=5345
					http://www.xiami.com/song/1772130322
					http://music.163.com/album?id=2635059
					http://www.xiami.com/album/32449

				  $ zx -f /tmp/foo.txt

### Proxy setting

**海外IP下载xiami资源**

xiami.com屏蔽了海外ip的http请求。在配置文件中添加（如果不存在的话）`xiami.proxy.http=ip:port` 可以让zhuaxia通过代理来解析xiami资源。
例如：

	xiami.proxy.http=127.0.0.1:8080

这里`ip:port`构成的http代理是国内的代理服务器。 如果你的机器已经是国内的ip，请注释或删除这个选项。获取国内代理的简单方法：到http://proxy-list.org/ 搜索China的代理就好。

## Screenshots

- downloading (gif animation)
![progress](https://raw.github.com/sk1418/sharedResources/master/zhuaxia/progress.gif)

- parse input file
![file view](https://raw.github.com/sk1418/sharedResources/master/zhuaxia/fileParse.gif)

- parse url
![url view](https://raw.github.com/sk1418/sharedResources/master/zhuaxia/urlParse.png)

## Changelog

[Click to check Change logs](CHANGELOG.txt)
